!function(e){var t={};function n(r){if(t[r])return t[r].exports;var a=t[r]={i:r,l:!1,exports:{}};return e[r].call(a.exports,a,a.exports,n),a.l=!0,a.exports}n.m=e,n.c=t,n.d=function(e,t,r){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var a in e)n.d(r,a,function(t){return e[t]}.bind(null,a));return r},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=24)}([function(e,t){!function(){e.exports=this.wp.element}()},function(e,t){function n(t){return e.exports=n=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},n(t)}e.exports=n},function(e,t){!function(){e.exports=this.React}()},function(e,t){!function(){e.exports=this.wp.components}()},function(e,t){e.exports=function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}},function(e,t){function n(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}e.exports=function(e,t,r){return t&&n(e.prototype,t),r&&n(e,r),e}},function(e,t,n){var r=n(14);e.exports=function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&r(e,t)}},function(e,t,n){var r=n(15),a=n(10);e.exports=function(e,t){return!t||"object"!==r(t)&&"function"!=typeof t?a(e):t}},,function(e,t){!function(){e.exports=this.wp.date}()},function(e,t){e.exports=function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}},function(e,t){!function(){e.exports=this.wp.apiFetch}()},function(e,t){!function(){e.exports=this.wp.compose}()},,function(e,t){function n(t,r){return e.exports=n=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},n(t,r)}e.exports=n},function(e,t){function n(t){return"function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?e.exports=n=function(e){return typeof e}:e.exports=n=function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},n(t)}e.exports=n},,function(e,t){},function(e,t){},,,,,,function(e,t,n){"use strict";n.r(t);n(17),n(18);var r=n(0);function a(){wp.data.dispatch("core/editor").editPost({meta:{_non_existing_meta:!0}})}function o(){return moment().valueOf()>moment(GatherPress.event_datetime.datetime_end).valueOf()}var i=n(11),c=n.n(i),s=n(4),u=n.n(s),l=n(5),f=n.n(l),m=n(6),p=n.n(m),d=n(7),h=n.n(d),v=n(1),b=n.n(v),_=n(2),y=n(9);function g(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=b()(e);if(t){var a=b()(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return h()(this,n)}}function O(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;k(e),GatherPress.event_datetime.datetime_start=e,this.setState({dateTime:e}),null!==t&&t({dateTime:e}),a()}function j(){return GatherPress.event_datetime.datetime_start=this.state.dateTime,this.state.dateTime}var P=function(e){p()(n,e);var t=g(n);function n(e){var r;return u()(this,n),(r=t.call(this,e)).state={dateTime:GatherPress.event_datetime.datetime_start},r}return f()(n,[{key:"componentDidMount",value:function(){this.updateDateTimeStart=O,this.getDateTimeStart=j,O=O.bind(this),j=j.bind(this)}},{key:"componentWillUnmount",value:function(){O=this.updateDateTimeStart,j=this.getDateTimeStart}},{key:"render",value:function(){var e=Object(y.__experimentalGetSettings)();return Object(y.dateI18n)("".concat(e.formats.date," ").concat(e.formats.time),this.state.dateTime)}}]),n}(_.Component);function w(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=b()(e);if(t){var a=b()(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return h()(this,n)}}var E=wp.i18n.__;function S(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;R(e),GatherPress.event_datetime.datetime_end=e,this.setState({dateTime:e}),null!==t&&t({dateTime:e}),a()}function x(){return GatherPress.event_datetime.datetime_end=this.state.dateTime,T(),this.state.dateTime}function T(){var e="gp_event_past",t=wp.data.dispatch("core/notices"),n=o();t.removeNotice(e),n&&t.createNotice("warning",E("This event has already past.","gatherpress"),{id:e,isDismissible:!0})}var D=function(e){p()(n,e);var t=w(n);function n(e){var r;return u()(this,n),(r=t.call(this,e)).state={dateTime:GatherPress.event_datetime.datetime_end},r}return f()(n,[{key:"componentDidMount",value:function(){this.updateDateTimeEnd=S,this.getDateTimeEnd=x,S=S.bind(this),x=x.bind(this),T()}},{key:"componentWillUnmount",value:function(){S=this.updateDateTimeEnd,x=this.getDateTimeEnd}},{key:"componentDidUpdate",value:function(){T()}},{key:"render",value:function(){var e=Object(y.__experimentalGetSettings)();return Object(y.dateI18n)("".concat(e.formats.date," ").concat(e.formats.time),this.state.dateTime)}}]),n}(_.Component),G="YYYY-MM-DDTHH:mm:ss";function k(e){var t=moment(GatherPress.event_datetime.datetime_end).valueOf(),n=moment(e).valueOf();n>=t&&S(moment(n).add(2,"hours").format(G));T()}function R(e){var t=moment(GatherPress.event_datetime.datetime_start).valueOf(),n=moment(e).valueOf();n<=t&&O(moment(n).subtract(2,"hours").format(G));T()}var C=n(3),M=n(12),Y=Object(M.withState)()((function(e){var t=e.setState,n=Object(y.__experimentalGetSettings)(),a=/a(?!\\)/i.test(n.formats.time.toLowerCase().replace(/\\\\/g,"").split("").reverse().join(""));return Object(r.createElement)(C.DateTimePicker,{currentDate:j(),onChange:function(e){return O(e,t)},is12Hour:a})})),H=Object(M.withState)()((function(e){var t=e.setState,n=Object(y.__experimentalGetSettings)(),a=/a(?!\\)/i.test(n.formats.time.toLowerCase().replace(/\\\\/g,"").split("").reverse().join(""));return Object(r.createElement)(C.DateTimePicker,{currentDate:x(),onChange:function(e){return S(e,t)},is12Hour:a})})),L=wp.i18n.__,A=moment().format(G),B=GatherPress.event_datetime.datetime_start,N=GatherPress.event_datetime.datetime_end;wp.data.subscribe((function(){var e=wp.data.select("core/editor").isSavingPost(),t=wp.data.select("core/editor").isAutosavingPost();e&&!t&&c()({path:"/gatherpress/v1/event/datetime/",method:"POST",data:{post_id:GatherPress.post_id,datetime_start:moment(GatherPress.event_datetime.datetime_start).format("YYYY-MM-DD HH:mm:ss"),datetime_end:moment(GatherPress.event_datetime.datetime_end).format("YYYY-MM-DD HH:mm:ss"),_wpnonce:GatherPress.nonce}}).then((function(e){}))})),B=""!==B?moment(B).format(G):A,N=""!==N?moment(N).format(G):moment(A).add(2,"hours").format(G),GatherPress.event_datetime.datetime_start=B,GatherPress.event_datetime.datetime_end=N;var q=function(){return Object(r.createElement)("section",null,Object(r.createElement)("h3",null,L("Date & time","gatherpress")),Object(r.createElement)(C.PanelRow,null,Object(r.createElement)("span",null,L("Start","gatherpress")),Object(r.createElement)(C.Dropdown,{position:"bottom left",renderToggle:function(e){var t=e.isOpen,n=e.onToggle;return Object(r.createElement)(C.Button,{onClick:n,"aria-expanded":t,isLink:!0},Object(r.createElement)(P,null))},renderContent:function(){return Object(r.createElement)(Y,null)}})),Object(r.createElement)(C.PanelRow,null,Object(r.createElement)("span",null,L("End","gatherpress")),Object(r.createElement)(C.Dropdown,{position:"bottom left",renderToggle:function(e){var t=e.isOpen,n=e.onToggle;return Object(r.createElement)(C.Button,{onClick:n,"aria-expanded":t,isLink:!0},Object(r.createElement)(D,null))},renderContent:function(){return Object(r.createElement)(H,null)}})))};function U(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=b()(e);if(t){var a=b()(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return h()(this,n)}}var I=wp.i18n.__,Q=function(e){p()(n,e);var t=U(n);function n(e){var r;return u()(this,n),(r=t.call(this,e)).state={announceEventSent:"0"!==GatherPress.event_announced},r}return f()(n,[{key:"announce",value:function(){var e=this;confirm(I("Ready to announce this event to all members?","gatherpress"))&&c()({path:"/gatherpress/v1/event/announce/",method:"POST",data:{post_id:GatherPress.post_id,_wpnonce:GatherPress.nonce}}).then((function(t){GatherPress.event_announced=t.success?"1":"0",e.setState({announceEventSent:t.success})}))}},{key:"shouldDisable",value:function(){return this.state.announceEventSent||"publish"!==wp.data.select("core/editor").getEditedPostAttribute("status")||o()}},{key:"render",value:function(){var e=this;return Object(r.createElement)("section",null,Object(r.createElement)("h3",null,I("Options","gatherpress")),Object(r.createElement)(C.PanelRow,null,Object(r.createElement)("span",null,I("Announce event","gatherpress")),Object(r.createElement)(C.Button,{className:"components-button is-primary","aria-disabled":this.shouldDisable(),onClick:function(){return e.announce()},disabled:this.shouldDisable()},this.state.announceEventSent?I("Sent","gatherpress"):I("Send","gatherpress"))))}}]),n}(_.Component),W=function(){return Object(r.createElement)(Q,null)},Z=wp.plugins.registerPlugin,F=wp.i18n.__,z=wp.editPost.PluginDocumentSettingPanel;Z("gp-event-settings",{render:function(){return"gp_event"===wp.data.select("core/editor").getCurrentPostType()&&Object(r.createElement)(z,{name:"gp-event-settings",title:F("Event settings","gatherpress"),initialOpen:!0,className:"gp-event-settings"},Object(r.createElement)(q,null),Object(r.createElement)("hr",null),Object(r.createElement)(W,null))},icon:""});var J=Object(r.createElement)("svg",{id:"Layer_1","data-name":"Layer 1",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 147.1 147.1"},Object(r.createElement)("title",null,"GatherPress"),Object(r.createElement)("circle",{cx:"73.5",cy:"73.5",r:"73.5",fill:"#23c3aa"}),Object(r.createElement)("path",{d:"M791.8,520.2l-23.5,15.1s26.8,20.9,18.5,43.6l-42.8,34.5c-27.4-2.7-60.5-30.4-60.5-71l41.7-35.8c5.8.7,16.5-3.5,23.6-3.4C772.1,503.6,779.1,505,791.8,520.2Z",transform:"translate(-683.3 -467.9)",fill:"#36a08b"}),Object(r.createElement)("path",{d:"M763.6,538.1H797a2.9,2.9,0,0,1,2.9,2.9h0a59.4,59.4,0,0,1-2.3,17.4,36.9,36.9,0,0,1-7.6,13.1Q777.8,585,759.1,585a42.4,42.4,0,0,1-31.3-13.2,45.4,45.4,0,0,1,51.5-73,49.1,49.1,0,0,1,12.3,8.9,6.1,6.1,0,0,1,0,8.7l-.4.4a6,6,0,0,1-8.5-.1q-9.5-9.7-22.2-9.7a31.2,31.2,0,0,0-23.2,9.5Q728,526,728,540T738.4,564q9.7,8.7,21.1,8.7a26.2,26.2,0,0,0,17.4-6.5q7.7-6.6,8.6-15.8H763.6a6.2,6.2,0,0,1-6.2-6.2h0A6.2,6.2,0,0,1,763.6,538.1Z",transform:"translate(-683.3 -467.9)",fill:"#fff",stroke:"#fff","stroke-miterlimit":"10","stroke-width":"6"}));wp.blocks.updateCategory("gatherpress",{icon:J})}]);