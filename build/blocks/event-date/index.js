(()=>{"use strict";var e,t={4034:(e,t,r)=>{const a=window.wp.blocks,n=window.moment;var s=r.n(n);function i(e){var t,r,a="";if("string"==typeof e||"number"==typeof e)a+=e;else if("object"==typeof e)if(Array.isArray(e)){var n=e.length;for(t=0;t<n;t++)e[t]&&(r=i(e[t]))&&(a&&(a+=" "),a+=r)}else for(r in e)e[r]&&(a&&(a+=" "),a+=r);return a}const o=function(){for(var e,t,r=0,a="",n=arguments.length;r<n;r++)(e=arguments[r])&&(t=i(e))&&(a&&(a+=" "),a+=t);return a},l=window.wp.i18n,d=window.wp.blockEditor,p=window.wp.components,u=window.wp.data,c=window.wp.element;function m(e){if("object"==typeof GatherPress)return e.split(".").reduce(((e,t)=>e&&e[t]),GatherPress)}function h(e,t){if("object"!=typeof GatherPress)return;const r=e.split("."),a=r.pop();r.reduce(((e,t)=>{var r;return null!==(r=e[t])&&void 0!==r?r:e[t]={}}),GatherPress)[a]=t}function g(){(0,u.dispatch)("core/editor")?.editPost({meta:{_non_existing_meta:!0}})}const f=window.wp.date,_=window.ReactJSXRuntime,x="YYYY-MM-DD HH:mm:ss",v=s().tz(b()).add(1,"day").set("hour",18).set("minute",0).set("second",0).format(x),T=(s().tz(v,b()).add(2,"hours").format(x),[{label:(0,l.__)("1 hour","gatherpress"),value:1},{label:(0,l.__)("1.5 hours","gatherpress"),value:1.5},{label:(0,l.__)("2 hours","gatherpress"),value:2},{label:(0,l.__)("3 hours","gatherpress"),value:3},{label:(0,l.__)("Set an end timeâ€¦","gatherpress"),value:!1}]);function D(e){return s().tz(function(){let e=m("eventDetails.dateTime.datetime_start");return e=""!==e?s().tz(e,b()).format(x):v,h("eventDetails.dateTime.datetime_start",e),e}(),b()).add(e,"hours").format(x)}function j(){return w(m("settings.dateFormat"))+" "+w(m("settings.timeFormat"))}function b(e=m("eventDetails.dateTime.timezone")){return s().tz.zone(e)?e:(0,l.__)("GMT","gatherpress")}function y(e=""){const t=/^([+-])(\d{2}):(00|15|30|45)$/,r=e.replace(t,"$1");return r!==e?"UTC"+r+parseInt(e.replace(t,"$2")).toString()+e.replace(t,"$3").replace("00","").replace("15",".25").replace("30",".5").replace("45",".75"):e}function z(e,t=null,r=null){!function(e,t=null){const r=s().tz(m("eventDetails.dateTime.datetime_end"),b()).valueOf(),a=s().tz(e,b()).valueOf();a>=r&&S(s().tz(a,b()).add(2,"hours").format(x),t)}(e,r),h("eventDetails.dateTime.datetime_start",e),"function"==typeof t&&t(e),g()}function S(e,t=null,r=null){!function(e,t=null){const r=s().tz(m("eventDetails.dateTime.datetime_start"),b()).valueOf(),a=s().tz(e,b()).valueOf();a<=r&&z(s().tz(a,b()).subtract(2,"hours").format(x),t)}(e,r),h("eventDetails.dateTime.datetime_end",e),null!==t&&t(e),g()}function w(e){const t={d:"DD",D:"ddd",j:"D",l:"dddd",N:"E",S:"o",w:"e",z:"DDD",W:"W",F:"MMMM",m:"MM",M:"MMM",n:"M",t:"",L:"",o:"YYYY",Y:"YYYY",y:"YY",a:"a",A:"A",B:"",g:"h",G:"H",h:"hh",H:"HH",i:"mm",s:"ss",u:"SSS",e:"zz",I:"",O:"",P:"",T:"",Z:"",c:"",r:"",U:"X"};return String(e).split("").map(((e,r,a)=>{const n=a[r-1];return e in t&&"\\"!==n?t[e]:e})).join("")}function C(){return"gatherpress_event"===(0,u.select)("core/editor")?.getCurrentPostType()}function E(){const e="gatherpress_event_past",t=(0,u.dispatch)("core/notices");t.removeNotice(e),function(){const e=s().tz(m("eventDetails.dateTime.datetime_end"),b());return"gatherpress_event"===(0,u.select)("core/editor")?.getCurrentPostType()&&s().tz(b()).valueOf()>e.valueOf()}()&&t.createNotice("warning",(0,l.__)("This event has already passed.","gatherpress"),{id:e,isDismissible:!1})}const k=()=>{const{dateTimeStart:e,duration:t}=(0,u.useSelect)((e=>({dateTimeStart:e("gatherpress/datetime").getDateTimeStart(),duration:e("gatherpress/datetime").getDuration()})),[]),{setDateTimeStart:r,setDateTimeEnd:a}=(0,u.useDispatch)("gatherpress/datetime"),n=(0,f.getSettings)(),i=/a(?!\\)/i.test(n.formats.time.toLowerCase().replace(/\\\\/g,"").split("").reverse().join(""));return(0,c.useEffect)((()=>{r(s().tz(e,b()).format(x)),t&&a(D(t)),E()}),[e,t,r,a]),(0,_.jsx)(p.PanelRow,{children:(0,_.jsxs)(p.Flex,{direction:"column",gap:"1",children:[(0,_.jsx)(p.FlexItem,{children:(0,_.jsx)("h3",{style:{marginBottom:0},children:(0,_.jsx)("label",{htmlFor:"gatherpress-datetime-start",children:(0,l.__)("Date & time start","gatherpress")})})}),(0,_.jsx)(p.FlexItem,{children:(0,_.jsx)(p.Dropdown,{popoverProps:{placement:"bottom-end"},renderToggle:({isOpen:t,onToggle:r})=>(0,_.jsx)(p.Button,{id:"gatherpress-datetime-start",onClick:r,"aria-expanded":t,isLink:!0,children:s().tz(e,b()).format(j())}),renderContent:()=>(0,_.jsx)(p.DateTimePicker,{currentDate:e,onChange:e=>{z(e,r,a)},is12Hour:i})})})]})})},O=()=>{const{dateTimeEnd:e}=(0,u.useSelect)((e=>({dateTimeEnd:e("gatherpress/datetime").getDateTimeEnd()})),[]),{setDateTimeEnd:t,setDateTimeStart:r}=(0,u.useDispatch)("gatherpress/datetime"),a=(0,f.getSettings)(),n=/a(?!\\)/i.test(a.formats.time.toLowerCase().replace(/\\\\/g,"").split("").reverse().join(""));return(0,c.useEffect)((()=>{t(s().tz(e,b()).format(x)),E()})),(0,_.jsx)(p.PanelRow,{children:(0,_.jsxs)(p.Flex,{direction:"column",gap:"1",children:[(0,_.jsx)(p.FlexItem,{children:(0,_.jsx)("h3",{style:{marginBottom:0},children:(0,_.jsx)("label",{htmlFor:"gatherpress-datetime-end",children:(0,l.__)("Date & time end","gatherpress")})})}),(0,_.jsx)(p.FlexItem,{children:(0,_.jsx)(p.Dropdown,{popoverProps:{placement:"bottom-end"},renderToggle:({isOpen:t,onToggle:r})=>(0,_.jsx)(p.Button,{id:"gatherpress-datetime-end",onClick:r,"aria-expanded":t,isLink:!0,children:s().tz(e,b()).format(j())}),renderContent:()=>(0,_.jsx)(p.DateTimePicker,{currentDate:e,onChange:e=>S(e,t,r),is12Hour:n})})})]})})},F=()=>{const{timezone:e}=(0,u.useSelect)((e=>({timezone:e("gatherpress/datetime").getTimezone()})),[]),{setTimezone:t}=(0,u.useDispatch)("gatherpress/datetime"),r=m("misc.timezoneChoices");return(0,c.useEffect)((()=>{t(m("eventDetails.dateTime.timezone"))}),[t]),(0,_.jsx)(p.PanelRow,{children:(0,_.jsx)(p.SelectControl,{label:(0,l.__)("Time Zone","gatherpress"),value:y(e),onChange:e=>{e=function(e=""){const t=/^UTC([+-])(\d+)(.\d+)?$/,r=e.replace(t,"$1");if(r!==e){const a=e.replace(t,"$2").padStart(2,"0");let n=e.replace(t,"$3");return""===n&&(n=":00"),n=n.replace(".25",":15").replace(".5",":30").replace(".75",":45"),r+a+n}return e}(e),t(e),g()},__nexthasnomarginbottom:!0,children:Object.keys(r).map((e=>(0,_.jsx)("optgroup",{label:e,children:Object.keys(r[e]).map((t=>(0,_.jsx)("option",{value:t,children:r[e][t]},t)))},e)))})})},P=()=>{const{duration:e}=(0,u.useSelect)((e=>({duration:e("gatherpress/datetime").getDuration()})),[]),t=(0,u.useDispatch)(),{setDateTimeEnd:r,setDuration:a}=t("gatherpress/datetime");return(0,_.jsx)(p.SelectControl,{label:(0,l.__)("Duration","gatherpress"),value:!!T.some((t=>t.value===e))&&e,options:T,onChange:e=>{(e="false"!==e&&parseFloat(e))&&r(D(e)),a(e)},__nexthasnomarginbottom:!0})},M=()=>{const e=(0,u.useDispatch)("core/editor").editPost;let t=(0,u.useSelect)((e=>e("core/editor").getEditedPostAttribute("meta")?.gatherpress_datetime));try{t=t?JSON.parse(t):{}}catch(e){t={}}const{dateTimeStart:r,dateTimeEnd:a,duration:n,timezone:i}=(0,u.useSelect)((e=>({dateTimeStart:e("gatherpress/datetime").getDateTimeStart(),dateTimeEnd:e("gatherpress/datetime").getDateTimeEnd(),duration:e("gatherpress/datetime").getDuration(),timezone:e("gatherpress/datetime").getTimezone()})),[]),{setDuration:o}=(0,u.useDispatch)("gatherpress/datetime");return(0,c.useEffect)((()=>{const n=JSON.stringify({...t,dateTimeStart:s().tz(r,i).format(x),dateTimeEnd:s().tz(a,i).format(x),timezone:i});e({meta:{gatherpress_datetime:n}})}),[r,a,i,t,e,o,n]),(0,_.jsxs)(_.Fragment,{children:[(0,_.jsx)("section",{children:(0,_.jsx)(k,{})}),(0,_.jsx)("section",{children:n?(0,_.jsx)(P,{}):(0,_.jsx)(O,{})}),(0,_.jsx)("section",{children:(0,_.jsx)(F,{})})]})},Y=m("settings.dateFormat"),$=m("settings.timeFormat"),I=m("settings.showTimezone"),A=`${Y} ${$}`,B=(e,t,r,a,n,i,o)=>{r=b(r);let d=!1;if(e&&t&&!a&&!n){const a=w(Y);d=s().tz(e,r).format(a)===s().tz(t,r).format(a)}const p=[];return e&&(a=w(a||A),p.push(s().tz(e,r).format(a))),e&&t&&p.push(i),t&&(n=w(d?$:n||A),p.push(s().tz(t,r).format(n))),(o?"yes"===o:I)&&p.push(s().tz(t||e,r).format("z")),p.push(function(e){return e=b(e),(0,l.__)("GMT","gatherpress")!==e?"":function(e=""){return e.replace(":","")}(m("eventDetails.dateTime.timezone"))}(r)),p.filter((e=>e)).join(" ")},N=JSON.parse('{"$schema":"https://schemas.wp.org/trunk/block.json","apiVersion":3,"name":"gatherpress/event-date","version":"2.0.0","title":"Event Date","category":"gatherpress","icon":"clock","example":{"viewportWidth":350},"description":"Displays the date and time for an event.","usesContext":["postId","queryId"],"attributes":{"eventEnd":{"type":"string"},"eventStart":{"type":"string"},"textAlign":{"type":"string"},"displayType":{"type":"string","default":"both"},"startDateFormat":{"type":"string","default":""},"endDateFormat":{"type":"string","default":""},"separator":{"//":"@todo Add this to plugin settings","type":"string","default":"to"},"showTimezone":{"type":"string","default":""}},"supports":{"gatherpress":{"postIdOverride":true},"html":false,"color":{"gradients":true,"link":true,"__experimentalDefaultControls":{"background":true,"text":true,"link":true}},"spacing":{"margin":true,"padding":true},"typography":{"fontSize":true,"lineHeight":true,"__experimentalFontFamily":true,"__experimentalFontWeight":true,"__experimentalFontStyle":true,"__experimentalTextTransform":true,"__experimentalTextDecoration":true,"__experimentalLetterSpacing":true,"__experimentalDefaultControls":{"fontSize":true}},"interactivity":{"clientNavigation":true},"__experimentalBorder":{"radius":true,"color":true,"width":true,"style":true,"__experimentalDefaultControls":{"radius":true,"color":true,"width":true,"style":true}}},"textdomain":"gatherpress","editorScript":"file:./index.js","style":"file:./style-index.css","render":"file:./render.php"}');(0,a.registerBlockType)(N,{edit:({attributes:e,setAttributes:t,context:r})=>{var a,n;const{textAlign:s,displayType:i,startDateFormat:c,endDateFormat:m,separator:h,showTimezone:g}=e,f=(0,d.useBlockProps)({className:o({[`has-text-align-${s}`]:s})}),x=null!==(a=null!==(n=e?.postId)&&void 0!==n?n:r?.postId)&&void 0!==a?a:null,{dateTimeStart:v,dateTimeEnd:T,timezone:D}=(0,u.useSelect)((e=>{if(C())return{dateTimeStart:e("gatherpress/datetime").getDateTimeStart(),dateTimeEnd:e("gatherpress/datetime").getDateTimeEnd(),timezone:e("gatherpress/datetime").getTimezone()};const t=e("core").getEntityRecord("postType","gatherpress_event",x)?.meta;return{dateTimeStart:t?.gatherpress_datetime_start,dateTimeEnd:t?.gatherpress_datetime_end,timezone:t?.gatherpress_timezone}}),[x]);if(!v||!T||!D)return(0,_.jsx)("div",{...f,children:(0,_.jsx)(p.Spinner,{})});const j=["start","both"].includes(i),b=["end","both"].includes(i);return(0,_.jsxs)("div",{...f,children:[(0,_.jsx)(d.BlockControls,{children:(0,_.jsx)(d.AlignmentToolbar,{value:s,onChange:e=>t({textAlign:e})})}),B(j?v:null,b?T:null,D,c,m,h,g),C()&&(0,_.jsx)(d.InspectorControls,{children:(0,_.jsxs)(p.PanelBody,{children:[(0,_.jsx)(p.__experimentalVStack,{spacing:4,children:(0,_.jsx)(M,{})}),(0,_.jsx)("div",{style:{height:"1rem"}}),(0,_.jsx)(p.RadioControl,{label:(0,l.__)("Display","gatherpress"),selected:i,options:[{label:(0,l.__)("Start and end date","getherpress"),value:"both"},{label:(0,l.__)("Start date only","gatherpress"),value:"start"},{label:(0,l.__)("End date only","gatherpress"),value:"end"}],onChange:e=>t({displayType:e})}),"both"===i&&(0,_.jsx)(p.TextControl,{label:(0,l.__)("Separator","gatherpress"),value:h,placeholder:(0,l.__)("to","gatherpress"),onChange:e=>t({separator:e})}),j&&(0,_.jsx)(p.TextControl,{label:(0,l.__)("Start date format","gatherpress"),value:c,placeholder:`${Y} ${$}`,onChange:e=>t({startDateFormat:e})}),b&&(0,_.jsx)(p.TextControl,{label:(0,l.__)("End date format","gatherpress"),value:m,placeholder:`${Y} ${$}`,onChange:e=>t({endDateFormat:e})}),(0,_.jsx)("p",{className:"components-base-control__help",children:(0,_.jsx)("a",{href:"https://wordpress.org/documentation/article/customize-date-and-time-format/",target:"_blank",rel:"noreferrer",children:(0,l.__)("Date/time formatting documentation","gatherpress")})}),(0,_.jsx)(p.SelectControl,{label:(0,l.__)("Show time zone","gatherpress"),value:g,options:[{label:(0,l.__)("Default (plugin setting)","gatherpress"),value:""},{label:(0,l.__)("Yes","gatherpress"),value:"yes"},{label:(0,l.__)("No","gatherpress"),value:"no"}],onChange:e=>t({showTimezone:e})})]})})]})},save:()=>null})}},r={};function a(e){var n=r[e];if(void 0!==n)return n.exports;var s=r[e]={exports:{}};return t[e](s,s.exports,a),s.exports}a.m=t,e=[],a.O=(t,r,n,s)=>{if(!r){var i=1/0;for(p=0;p<e.length;p++){for(var[r,n,s]=e[p],o=!0,l=0;l<r.length;l++)(!1&s||i>=s)&&Object.keys(a.O).every((e=>a.O[e](r[l])))?r.splice(l--,1):(o=!1,s<i&&(i=s));if(o){e.splice(p--,1);var d=n();void 0!==d&&(t=d)}}return t}s=s||0;for(var p=e.length;p>0&&e[p-1][2]>s;p--)e[p]=e[p-1];e[p]=[r,n,s]},a.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return a.d(t,{a:t}),t},a.d=(e,t)=>{for(var r in t)a.o(t,r)&&!a.o(e,r)&&Object.defineProperty(e,r,{enumerable:!0,get:t[r]})},a.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),(()=>{var e={1532:0,6004:0};a.O.j=t=>0===e[t];var t=(t,r)=>{var n,s,[i,o,l]=r,d=0;if(i.some((t=>0!==e[t]))){for(n in o)a.o(o,n)&&(a.m[n]=o[n]);if(l)var p=l(a)}for(t&&t(r);d<i.length;d++)s=i[d],a.o(e,s)&&e[s]&&e[s][0](),e[s]=0;return a.O(p)},r=globalThis.webpackChunkgatherpress=globalThis.webpackChunkgatherpress||[];r.forEach(t.bind(null,0)),r.push=t.bind(null,r.push.bind(r))})();var n=a.O(void 0,[6004],(()=>a(4034)));n=a.O(n)})();